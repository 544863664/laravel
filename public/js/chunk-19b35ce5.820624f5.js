(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19b35ce5"],{"13d9":function(e,t,a){},"3bff":function(e,t,a){"use strict";var i=a("13d9"),s=a.n(i);s.a},c90f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Deliverypage"},[a("div",{staticClass:"pagewrap"},[a("div",{staticClass:"title"},[e._v("快递名称："+e._s(e.express_name||"自运"))]),e.express_number?a("div",{staticClass:"title"},[e._v("快递编号："+e._s(e.express_number))]):a("div",{staticClass:"title"},[e._v("车牌号："+e._s(e.vehicle_numbers))])]),e.express_number?a("div",{staticClass:"delived"},[e.activities.length?a("el-timeline",{attrs:{reverse:!1}},e._l(e.activities,function(t,i){return a("el-timeline-item",{key:i,attrs:{timestamp:t.time,color:t.color}},[e._v("\n\t\t\t\t"+e._s(t.context)+"\n\t\t\t")])}),1):a("div",{staticClass:"nulldelive"},[e._v("未跟踪到物流信息")])],1):a("lbs-map",{ref:"lbsmap",attrs:{center:e.map.center,zoom:e.map.zoom,maptype:e.map.mapType}},[a("div",{staticClass:"toolbar"},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期时间","end-placeholder":"结束日期时间","default-time":["12:00:00"]},on:{change:e.changetime},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}}),a("el-button",{staticStyle:{"margin-left":"10px"},on:{click:e.loadData}},[e._v("查看轨迹")]),a("el-button",{on:{click:e.play}},[e._v(e._s(e.move.pauseName))]),a("el-button",{on:{click:e.clean}},[e._v("清空")])],1)]),a("lbs-marker",{attrs:{coord:e.marker.coord,color:"green",label:"","icon-image-url":"",angle:e.marker.angle,visible:!0,type:"car"}}),a("lbs-popup",{attrs:{header:e.popup.header,topRight:e.popup.topRight,coord:e.popup.point,content:e.popup.content,footer:e.popup.footer,visible:e.popup.visible}}),a("lbs-move",{attrs:{name:"车牌号："+e.vehicle_numbers,pause:e.move.pause,speed:1,posdata:e.move.posdata,runStep:1,filterlbs:!1}})],1)],1)},s=[],o=(a("7f7f"),a("cebc")),n=a("2f62"),r=a("c1df"),p=a.n(r),l={name:"Deliverypage",computed:Object(o["a"])({},Object(n["c"])({url:function(e){return e.url}}),Object(n["b"])({token:"getToken"})),data:function(){return{value1:"",deliveid:"",delivedata:{},activities:[],express_number:"",vehicle_numbers:"",express_name:"",imei:"",gpsbdtra:{imei:"",start:"",end:""},map:{center:[],zoom:16,mapType:"google"},driving:{start:[],end:[]},marker:{coord:[],angle:0},popup:{header:"",topRight:"GPS",point:[],content:[],footer:'<img width="16" height="16" src="http://oss.taiyangos.com/operator/ic_launcher.png">',visible:!0},move:{header:"",posdata:[],pause:!1,pauseName:"暂停"}}},created:function(){if(this.deliveid=this.$route.query.id,this.express_number=this.$route.query.express_number,this.vehicle_numbers=this.$route.query.vehicle_numbers,this.express_name=this.$route.query.express_name,this.imei=this.$route.query.imei,this.express_number)this.getdelivedetail();else{var e=[this.imei];this.getgpsbdlocation(e)}},methods:{getdelivedetail:function(){var e=this;e.axios({method:"GET",url:e.url+"/api/v1/express/express-detail",params:{id:e.deliveid},headers:{"content-type":"application/json",token:e.token}}).then(function(t){if(t&&t.data&&200==t.data.code){var a=t.data.data;e.delivedata=a,a.data&&a.data.length&&(a.data[0].color="#0bbd87",e.activities=a.data)}}).catch(function(e){console.log(e)})},getgpsbdlocation:function(e){var t=this;t.axios({method:"POST",url:t.url+"/api/v1/gpsbd/location",data:{IMEI:e},headers:{"content-type":"application/json",token:t.token}}).then(function(e){if(e&&e.data&&200==e.data.code){var a=e.data.data.data;t.map.center=[a[0].longitude,a[0].latitude],t.popup.point=[a[0].longitude,a[0].latitude],t.popup.header=a[0].name,t.popup.content=["时间："+p()(a[0].time).format("YYYY-MM-DD HH:mm:ss")],t.popup.visible=!0,t.marker.coord=[a[0].longitude,a[0].latitude],t.marker.angle=a[0].course}}).catch(function(e){console.log(e)})},result:function(e){0==e.code&&(console.log(e),this.driving.distance=e.data.distance,this.driving.duration=e.data.duration,console.log(e.data.polyline))},changetime:function(){var e=this.value1;this.gpsbdtra={imei:[],start:[],end:[]},e&&e[0]&&e[1]&&(this.gpsbdtra.imei=this.imei,this.gpsbdtra.start=p()(e[0]).format("YYYY-MM-DD HH:mm:ss"),this.gpsbdtra.end=p()(e[1]).format("YYYY-MM-DD HH:mm:ss"))},loadData:function(){this.move.posdata=[];var e=this;e.gpsbdtra.start&&e.gpsbdtra.end?setTimeout(function(){e.popup.visible=!1,e.marker.coord=[],e.getgpsbdtra(e.gpsbdtra.imei,e.gpsbdtra.start,e.gpsbdtra.end),e.move.posdata.length},500):e.$message({message:"请选择要查询的时间范围",type:"warning"})},play:function(){this.move.pause?(this.move.pause=!1,this.move.pauseName="暂停"):(this.move.pause=!0,this.move.pauseName="播放")},clean:function(){this.move.posdata=[],this.value1="",this.getgpsbdlocation([this.imei])},getgpsbdtra:function(e,t,a){var i=this;i.axios({method:"GET",url:i.url+"/api/v1/gpsbd/tra",params:{IMEI:e,start:t,end:a},headers:{"content-type":"application/json",token:i.token}}).then(function(e){if(e&&e.data&&200==e.data.code){var t=e.data.data.data;i.move.posdata=t}}).catch(function(e){console.log(e)})},getAngle:function(e,t,a,i){var s=(90-i)*Math.PI/180,o=(90-t)*Math.PI/180,n=(a-e)*Math.PI/180,r=Math.cos(s)*Math.cos(o)+Math.sin(s)*Math.sin(o)*Math.cos(n),p=Math.sqrt(1-r*r),l=Math.sin(s)*Math.sin(n)/p,d=180*Math.asin(l)/Math.PI,c=0;return a>e&&i>t?c=d:a>e&&i<t?c=180-d:a<e&&i<t?c=180-d:a<e&&i>t?c=360+d:a>e&&i==t?c=90:a<e&&i==t?c=270:a==e&&i>t?c=0:a==e&&i<t&&(c=180),c}}},d=l,c=(a("3bff"),a("2877")),u=Object(c["a"])(d,i,s,!1,null,"3e7148d2",null);t["default"]=u.exports}}]);