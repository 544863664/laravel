(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f512ee0"],{"0fcf":function(e,t,a){},"1ce7":function(e,t,a){"use strict";var l=a("0fcf"),n=a.n(l);n.a},"66d5":function(e,t,a){"use strict";var l=a("768e"),n=a.n(l);n.a},"768e":function(e,t,a){},cd9b:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Prodpage"},[a("div",{staticClass:"search"},[a("div",{staticClass:"demo-input-suffix"},[a("div",[a("el-input",{staticStyle:{width:"30.625rem"},attrs:{"suffix-icon":"el-icon-search",autofocus:"",placeholder:"搜索名称"},on:{input:e.searchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.search_name,callback:function(t){e.search_name="string"===typeof t?t.trim():t},expression:"search_name"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:e.searchChange},slot:"append"},[e._v("搜索")])],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",plain:""},on:{click:e.clearSearchChange}},[e._v("全部")])],1)])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading "}],attrs:{data:e.tableData.tableList,"header-cell-style":e.tableheader,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("el-table-column",{attrs:{label:"编号","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.product_id||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"代号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.item||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"型号规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.specs||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.number||""))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return e.prodclickdetail(t.row)}}},[e._v("详情")]),a("el-link",{staticStyle:{"margin-left":"10px"},attrs:{underline:!1,type:"primary",disabled:1!=t.row.is_upload},on:{click:function(a){return e.Upfile(t.row)}}},[e._v("报告")]),a("el-link",{staticStyle:{"margin-left":"10px"},attrs:{underline:!1,type:"primary",disabled:2==t.row.is_send},on:{click:function(a){return e.bulkshipment(t.row)}}},[e._v("发货")])]}}])})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.tableData.pageSize,layout:"sizes, prev, pager, next",total:e.tableData.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("Upfiledialog",{attrs:{UpfileDialogVisible:e.UpfileDialogVisible},on:{change:e.UpfileClose}}),a("Bulkship",{ref:"bulkship",attrs:{BulkshipdialogVisible:e.BulkshipDialogVisible},on:{change:e.BulkshipClose}})],1)},n=[],s=(a("7f7f"),a("cebc")),i=a("2f62"),o=a("c1df"),r=a.n(o),u=a("9cff"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bulkship"},[a("el-dialog",{attrs:{title:"发货列表",visible:e.BulkshipdialogVisible.dialog,width:"1100px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.BulkshipdialogVisible,"dialog",t)},close:e.bulkshipDialogclose}},[a("div",{staticClass:"bulkshipwrap"},[a("div",{staticClass:"search"},[a("div",{staticClass:"demo-input-suffix"},[a("el-input",{staticStyle:{width:"300px"},attrs:{"suffix-icon":"el-icon-search",autofocus:"",placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.search_name,callback:function(t){e.search_name="string"===typeof t?t.trim():t},expression:"search_name"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:e.searchChange},slot:"append"},[e._v("搜索")])],1),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.clearSearchChange}},[e._v("全部")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading "}],attrs:{data:e.tableData.tableList,"header-cell-style":e.tableheader,height:"526px","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.checkboxT,width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"编号",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.id||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.product_name||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"代号",width:"155"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.item||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"型号规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.specs||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"工序名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.procedure_name||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"工序",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.procedure_detail_number||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"批次",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.batch||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"数量",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.number||"-- --"))])]}}])}),a("el-table-column",{attrs:{label:"生产日期",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.created_at)))])]}}])}),a("el-table-column",{attrs:{label:"完成状态",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-link",{attrs:{underline:!1,size:"mini",type:"danger"}},[e._v("未开始")]):e._e(),2==t.row.status?a("el-link",{attrs:{underline:!1,size:"mini",type:"warning"}},[e._v("生产中")]):e._e(),3==t.row.status?a("el-link",{attrs:{underline:!1,size:"mini",type:""}},[e._v("已完成")]):e._e(),4==t.row.status?a("el-link",{attrs:{underline:!1,size:"mini",type:"success"}},[e._v("已配送")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"发货状态",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.status?a("el-link",{attrs:{underline:!1,type:"success"}},[e._v("已发货")]):a("el-link",{attrs:{underline:!1,type:""}},[e._v("未发货")])]}}])})],1)],1),a("el-pagination",{attrs:{layout:"prev, pager, next, jumper","page-size":e.tableData.pageSize,total:e.tableData.total},on:{"current-change":e.handleCurrentChange}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"downodebtn"},[a("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{model:e.ruleForm,rules:e.rules,inline:!0}},[a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"发货单填写",prop:"express_type"}},[a("el-select",{staticClass:"kuaidileixing",staticStyle:{width:"130px"},attrs:{filterable:"",placeholder:"快递类型"},model:{value:e.ruleForm.express_type,callback:function(t){e.$set(e.ruleForm,"express_type",t)},expression:"ruleForm.express_type"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),"0"==e.ruleForm.express_type?a("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"gps"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{filterable:"",placeholder:"GPS"},model:{value:e.ruleForm.gps,callback:function(t){e.$set(e.ruleForm,"gps",t)},expression:"ruleForm.gps"}},e._l(e.options2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),a("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"worklist"}},[a("el-select",{staticClass:"chejianmingcehng",attrs:{filterable:"",placeholder:"目的地"},model:{value:e.ruleForm.worklist,callback:function(t){e.$set(e.ruleForm,"worklist",t)},expression:"ruleForm.worklist"}},e._l(e.options1,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),"0"!=e.ruleForm.express_type?a("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"express_numbers"}},[a("el-input",{attrs:{maxlength:15,placeholder:"快递单号"},model:{value:e.ruleForm.express_numbers,callback:function(t){e.$set(e.ruleForm,"express_numbers","string"===typeof t?t.trim():t)},expression:"ruleForm.express_numbers"}})],1):a("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"vehicle_numbers"}},[a("el-input",{attrs:{maxlength:15,placeholder:"车牌号(自提请输入车牌号)"},model:{value:e.ruleForm.vehicle_numbers,callback:function(t){e.$set(e.ruleForm,"vehicle_numbers","string"===typeof t?t.trim():t)},expression:"ruleForm.vehicle_numbers"}})],1),a("el-form-item",[a("el-button",{on:{click:e.dialogclose}},[e._v("取 消")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:e.showbbb},on:{click:function(t){return e.bulkshipdata("ruleForm")}}},[e._v("发 货")])],1)],1)],1)])],1)],1)},p=[],d={name:"Bulkshipment",props:["BulkshipdialogVisible"],computed:Object(s["a"])({},Object(i["c"])({url:function(e){return e.url}}),Object(i["b"])({token:"getToken"})),filters:{formatDate:function(e){return r()(1e3*e).format("YYYY/MM/DD")}},data:function(){return{search_name:"",task:"0",options:[],options1:[],options2:[],loading:"",tableData:{tableList:[],currentPage:1,pageSize:10,total:0,bulkshipArr:[]},showbbb:!1,ruleForm:{express_type:"",express_numbers:"",vehicle_numbers:"",worklist:"",gps:""},rules:{gps:[{required:!0,message:"请选择GPS",trigger:"change"}],worklist:[{required:!0,message:"请选择目的地",trigger:"change"}],express_type:[{required:!0,message:"请选择快递类型",trigger:"change"}],express_numbers:[{required:!0,message:"请填写快递单号",trigger:"change"}],vehicle_numbers:[{required:!1,message:"请填写车牌号",trigger:"change"}]}}},methods:{getbulkshiplist:function(){var e=this;e.axios({method:"POST",url:e.url+"/api/v1/supplier/send-detail",params:{page:e.tableData.currentPage,size:e.tableData.pageSize,product_id:e.BulkshipdialogVisible.obj.product_id},headers:{"content-type":"application/json",token:e.token}}).then(function(t){if(t&&t.data&&200==t.data.code){var a=t.data.data;e.tableData.total=a.count.total,e.tableData.tableList=a.list,e.showbbb=!1,0==a.count.total&&e.bulkshipDialogclose()}}).catch(function(e){console.log(e)})},bulkshipdata:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;if(t.tableData.bulkshipArr.length){t.showbbb=!0;var a=t.tableData.bulkshipArr,l={express_type:t.ruleForm.express_type,express_numbers:t.ruleForm.express_numbers,vehicle_numbers:t.ruleForm.vehicle_numbers,work_shop_id:t.ruleForm.worklist,IMEI:t.ruleForm.gps};t.openFullScreen2(),t.axios({method:"POST",url:t.url+"/api/v1/supplier/send-many",data:{task_id:a},params:l,headers:{"content-type":"application/json",token:t.token}}).then(function(e){e&&200==e.data.code&&t.expressadd(a,l)}).catch(function(e){console.log(e),t.loading.close(),t.$message({message:t.errmessage(e.response.data),type:"warning"}),t.showbbb=!1})}else t.$message({message:"请选择要发货的数据",type:"warning"})})},expressadd:function(e,t){var a=this;a.axios({method:"POST",url:a.url+"/api/v1/express/express-add",data:{task_id:e},params:t,headers:{"content-type":"application/json",token:a.token}}).then(function(e){e&&200==e.data.code&&(a.$message({showClose:!0,message:"发货成功",type:"success"}),a.loading.close(),a.$refs.ruleForm.resetFields(),a.getbulkshiplist())}).catch(function(e){a.loading.close(),a.showbbb=!1,a.$message({message:a.errmessage(e.response.data),type:"warning"})})},searchChange:function(){console.log(this.search_name)},clearSearchChange:function(){this.search_name="",this.getbulkshiplist()},changetask:function(e){this.search_name="","0"==e?(this.task="",this.getbulkshiplist()):(this.task=e,this.getbulkshiplist())},handleCurrentChange:function(e){this.tableData.currentPage=e,this.getbulkshiplist()},handleSelectionChange:function(e){e.length>0?this.tableData.bulkshipArr=e.map(function(e){if(3==e.status)return e=e.id,e}):this.tableData.bulkshipArr=[]},checkboxT:function(e,t){return 3==e.status},getexpress_type:function(){var e=this;e.axios({method:"GET",url:e.url+"/api/v1/express",headers:{"content-type":"application/json",token:e.token}}).then(function(t){if(t&&t.data&&t.data.data&&200==t.data.code){var a=t.data.data;e.options.push({value:0,label:"自运"}),a.map(function(t){e.options.push({value:t.id,label:t.name})})}}).catch(function(e){console.log(e)})},getworklist:function(){var e=this;e.axios({method:"GET",url:e.url+"/api/v1/supplier/work-list",headers:{"content-type":"application/json",token:e.token}}).then(function(t){if(t&&t.data&&t.data.data&&200==t.data.code){var a=t.data.data;a.map(function(t){e.options1.push({value:t.id,label:t.name})})}}).catch(function(e){console.log(e)})},getGPSlist:function(){var e=this;e.axios({method:"GET",url:e.url+"/api/v1/gpsbd/list",headers:{"content-type":"application/json",token:e.token}}).then(function(t){if(t&&t.data&&t.data.data&&200==t.data.code){var a=t.data.data;e.options2=[],a.map(function(t){e.options2.push({value:t.IMEI,label:t.name})})}}).catch(function(e){console.log(e)})},tableheader:function(e){e.row,e.column;var t=e.rowIndex;e.columnIndex;if(0===t)return"background: rgb(243, 243, 243);padding: 6px 0;"},openFullScreen2:function(){this.loading=this.$loading({lock:!0,text:"发货中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},dialogclose:function(){this.$emit("change",!1)},bulkshipDialogclose:function(){this.$refs.ruleForm.resetFields(),this.search_name="",this.task="0",this.options=[],this.options1=[],this.options2=[],this.tableData={tableList:[],currentPage:1,pageSize:10,total:0,bulkshipArr:[]},this.showbbb=!1,this.$emit("change",!1)}}},h=d,f=(a("1ce7"),a("2877")),g=Object(f["a"])(h,c,p,!1,null,"02b30d3e",null),b=g.exports,m={name:"Prodpage",components:{Upfiledialog:u["a"],Bulkship:b},computed:Object(s["a"])({},Object(i["c"])({url:function(e){return e.url}}),Object(i["b"])({token:"getToken"})),filters:{formatDate:function(e){return r()(1e3*e).format("YYYY/MM/DD")}},data:function(){return{search_name:"",tableData:{loading:!0,tableList:[],currentPage:1,pageSize:15,total:0},UpfileDialogVisible:{dialog:!1,obj:{}},BulkshipDialogVisible:{dialog:!1,obj:{}},allCode:[],codeBtnshow:!1,showbtnbtn:!0}},created:function(){this.getProdpage()},methods:{getProdpage:function(){var e=this;e.axios({method:"GET",url:e.url+"/api/v1/supplier/task-product",data:"",params:{page:e.tableData.currentPage,size:e.tableData.pageSize,name:e.search_name},headers:{"content-type":"application/json",token:e.token}}).then(function(t){if(t&&t.data&&t.data.data&&200==t.data.code){var a=t.data.data.list;e.tableData.total=t.data.data.count.total,e.tableData.tableList=a,e.tableData.loading=!1}}).catch(function(t){console.log(t),e.tableData.loading=!1})},filterTag:function(e,t){return t.status===e},searchChange:function(){this.tableData.currentPage=1,this.search_name||(this.search_name=""),this.getProdpage()},handleSizeChange:function(e){this.tableData.pageSize=e,this.getProdpage()},handleCurrentChange:function(e){this.tableData.currentPage=e,this.getProdpage()},clearSearchChange:function(){this.search_name="",this.tableData.currentPage=1,this.getProdpage()},Upfile:function(e){e.t=1,e.u=1,e.product_name=e.name,this.UpfileDialogVisible.dialog=!0,this.UpfileDialogVisible.obj=e},downCode:function(e,t){var a=this.url;if(e&&t){location.href=a+"/api/v1/supplier/export?type="+t+"&task_id[0]="+e}else this.$message({type:"warning",message:"导出条码出错",offset:300})},handleSelectionChange:function(e){if(e.length>0){this.codeBtnshow=!0;var t="";e.map(function(e,a){e.id&&(t+="&task_id["+a+"]="+e.id)}),this.allCode=t}else this.codeBtnshow=!1,this.allCode=[]},allDownCode:function(e){var t=this.url;console.log(this.allCode,e),location.href=t+"/api/v1/supplier/export?type="+e+this.allCode},downAll:function(){var e=sessionStorage.getItem("Supplierid");e?location.href=this.url+"/api/v1/supplier/export-task?supplier_id="+e+"&name="+this.search_name:this.$message({message:"未知供应商，请检查供应商信息",offset:200})},prodclickdetail:function(e){e.product_id&&this.$router.push({path:"/production",query:{product_id:e.product_id}})},bulkshipment:function(e){this.BulkshipDialogVisible.obj=e,this.$refs.bulkship.getbulkshiplist(),this.$refs.bulkship.getexpress_type(),this.$refs.bulkship.getworklist(),this.$refs.bulkship.getGPSlist(),this.BulkshipDialogVisible.dialog=!0},BulkshipClose:function(e){this.BulkshipDialogVisible.dialog=e,this.getProdpage()},UpfileClose:function(e){this.UpfileDialogVisible.dialog=e,this.getProdpage()},tableheader:function(e){e.row,e.column;var t=e.rowIndex;e.columnIndex;if(0===t)return"height:50px;background:#e5e5e5"}}},k=m,_=(a("66d5"),Object(f["a"])(k,l,n,!1,null,"7db283c6",null));t["default"]=_.exports}}]);